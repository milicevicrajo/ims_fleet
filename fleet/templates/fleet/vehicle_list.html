{% extends 'base.html' %}
{% load form_filters %}
{% load ims_tags %}
{% block content %}
{% load humanize %} 
<h2>{{ title }}</h2>
<div class="card">
    <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="card-title">Tabela</h5>
            <a href={% url 'vehicle_create'%} class="text-success" style="font-size: 1.15em;">
                <i class="mdi mdi-plus-box"></i><i class="mdi mdi-car"></i> Dodaj vozilo
            </a>
        </div>
        <form method="get" class="row g-3 align-items-end pb-3">
            <div class="col-auto">
                <label for="id_fuel_in_last_6_months" class="col-form-label">{{ form.fuel_in_last_6_months.label }}:</label>
                <div>
                    {{ form.fuel_in_last_6_months|add_class:'form-control' }}
                </div>
            </div>
            
            <div class="col-auto">
                <label for="id_org_unit" class="col-form-label">{{ form.org_unit.label }}:</label>
                <div>
                    {{ form.org_unit|add_class:'form-control' }}
                </div>
            </div>
        
            <div class="col-auto">
                <label for="id_center_code" class="col-form-label">{{ form.center_code.label }}:</label>
                <div>
                    {{ form.center_code|add_class:'form-control' }}
                </div>
            </div>
        
            <!-- Dugme je sada poravnato sa poljima -->
            <div class="col-auto d-flex align-items-end">
                <button type="submit" class="btn btn-primary">Filtriraj</button>
            </div>
        </form>
        

        <div class="table-responsive">
            <table id="DatatableVozila" class="display">
                <thead>
                    <tr>
                        <th>Registracija</th>
                        <th>Marka</th>
                        <th>Tip</th>
                        <th>Godiste</th>
                        <th>Km</th>
                        <th>Potro≈°nja</th>
                        <th>Servisi cena</th>                        
                        <th>Vrednost nabavna</th>
                        <th>Vrednost trenutna</th>
                        <th>Izmeni</th>
                    </tr>
                </thead>
                <tbody>
                    {% for vehicle in vehicles %}
                    <tr>  
                        <td><a href="{% url 'vehicle_detail' vehicle.pk %}">{{ vehicle.registration_number }}</a></td>                   
                        <td>{{ vehicle.brand }}</td>                      
                        <td>{{ vehicle.model }}</td>
                        <td>{{ vehicle.year_of_manufacture }}</td>
                        <td>{{ vehicle.mileage }}</td>
                        <td>
                            {% if vehicle_consumption_data|dict_get:vehicle.id %}
                                {{ vehicle_consumption_data|dict_get:vehicle.id|floatformat:2 }}
                            {% else %}
                                0
                            {% endif %}
                        </td>
                        <td>{{ vehicle.total_repairs|default:0|floatformat:0 }}</td>
                        <td>{{ vehicle.purchase_value }}</td>
                        <td>{{ vehicle.value }}</td>
                        <td>
                            <a href="{% url 'vehicle_update' vehicle.pk %}">Izmeni</a>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="5">Nema opreme..</td>
                    </tr>
                {% endfor %}
                <tfoot>
                    <tr>
                        <th>Registracija</th>
                        <th>Marka</th>
                        <th>Tip</th>
                        <th>Godiste</th>
                        <th>Km</th>
                        <th>Br. Sasije</th>
                        <th>Servisi cena</th>                        
                        <th>Vrednost nabavna</th>
                        <th>Vrednost trenutna</th>
                        <th>Izmeni</th>
                    </tr>
                </tfoot>
            </table>
        </div>

    </div>
</div>

{% endblock %}